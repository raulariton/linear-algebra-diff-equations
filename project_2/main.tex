\documentclass[a4paper,12pt]{article}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{pgf}
\usepackage{float}
\usepackage{lmodern}
\usepackage{siunitx}
\DeclareSIUnit\mile{mi}

% default font selection
\renewcommand{\familydefault}{\sfdefault}
% \usepackage[default]{sourcesanspro}
% \usepackage{libertinus}

\lstset{
  language=Python,
  basicstyle=\ttfamily\small,
  keywordstyle=\color{blue},
  stringstyle=\color{orange},
  commentstyle=\color{gray},
  numbers=left,
  numberstyle=\tiny\color{gray},
  frame=single,
  breaklines=true,
}

\usepackage{graphicx}

% math symbols and fonts
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathrsfs}

% d for derivatives
\usepackage{fixdif}

% SI units
\usepackage{siunitx}

% framed environment, might use in problem introduction
\usepackage{framed}

% bibtex setup
\usepackage[backend=biber,
            style=ieee,
            ]{biblatex}
\addbibresource{bibliography.bib}

\usepackage{cancel}

% context-sensitive quotes package (biblatex suggests using it, idk what it does exactly)
\usepackage{csquotes}

% hyperref package; convention to always add as last package
\usepackage{hyperref}

% adding text spacing in math mode
\renewcommand*{\textnormal}[1]{\text{ #1 }}

% removing highlighting of hyperref links
\hypersetup{pdfborder={0 0 0}}

% remove indentation
\setlength{\parindent}{0pt}

\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}

\begin{document}

\begin{titlepage}
    \vspace*{-3cm}
    \centering
    \includegraphics[width=2cm]{assets/uvt_logo_en.png}

    {\scshape\LARGE West University of Timișoara\par}

    \vspace{1cm}

    {\large Faculty of Computer Science}

    \vspace{.1\textheight}
    { \LARGE \scshape Project 2: \\ Cleaning Up the Great Lakes \par}

    \vspace{.1\linewidth}

    {\emph{Authors:} \\
        Raul-Andrei \textsc{Ariton} (\textit{Group 2}) \\
        Maria-Miruna \textsc{Mesaroșiu} (\textit{Group 1}) \\
        Silviu-Ștefan \textsc{Mitrea} (\textit{Group 1}) \\
    }

    \vfill

    \rule{.4\textwidth}{.4pt}

    {\large \today\par
        Academic Year 2025-2026\par}
\end{titlepage}

\tableofcontents \newpage

\section{Cleaning Up the Great Lakes}

In this project, we aim to solve a \textit{compartmental modelling} problem proposed in \cite[pp.~313--314]{Kent_Nagle2018-ig}. The problem involves estimating the time it would take to clean up the Great Lakes (figure~\ref{fig:great_lakes}) of pollutants at varying levels of accuracy.

\begin{figure}[h!]
    \centering
    \includegraphics[width=0.7\textwidth]{assets/great_lakes.png}
    \caption{The Great Lakes of North America}
    \label{fig:great_lakes}
\end{figure}

\citeauthor*{Kent_Nagle2018-ig} models each lake as a tank, containing a liquid (water) dissolved with a pollutant (DDT, phosphorus, mercury).

The following assumptions are made and maintained for the entirety of the problem:
\begin{itemize}
    \item The volume of each lake remains constant.
    \item The flow rates are constant throughout the year.
    \item When a liquid enters the lake, perfect mixing occurs and the pollutants are uniformly distributed throughout the lakes.
    \item Pollutants are dissolved in the water and enter or leave by inflow or outflow of water.
\end{itemize}

\newpage \section{``Draining'' each lake of pollutants} \label{sec:draining_lakes}

\begin{framed}
    \noindent Use the outflow rates given to determine the time it would take to ``drain'' each lake. This gives a lower bound on how long it would take to remove all the pollutants.
\end{framed}

\begin{figure}[h!]
    \centering
    \includegraphics[width=\textwidth]{assets/great_lakes_compartmental_model.png}
    \caption{Compartmental model of the Great Lakes with flow rates ($\unit{\cubic\mile \per \text{year}}$) and volumes ($\unit{\cubic\mile}$) \cite{Kent_Nagle2018-ig}}
    \label{fig:great_lakes_model}
\end{figure}

It is important to note that, in this context, ``draining'' a lake does not refer to removing all the water from it, but rather to removing all the pollutants dissolved in the water.

Since we are given the outflow rates for each lake (in $\unit{\cubic\mile \per \text{year}}$) and the volumes of each lake (in $\unit{\cubic\mile}$) (see figure~\ref{fig:great_lakes_model}), the time (in years) that it would take to drain (remove all pollutants from) each lake can be simply computed as:
\begin{gather*}
    \text{Time to drain lake} = \frac{\text{Volume of lake}}{\text{Outflow rate}} \\
    t = \frac{V}{r}
\end{gather*}

Table~\ref{table:drain_times} shows the computed times to drain each lake, using the given volumes and outflow rates.

\begin{table}[h!]
    \centering
    \begin{tabular}{|c|c|}

        \hline

        Lake     & Time (in years) to ``drain'' \\

        \hline

        Superior & 193.33                       \\
        \hline
        Michigan & 31.05                        \\
        \hline
        Huron    & 12.50                        \\
        \hline
        Erie     & 1.36                         \\
        \hline
        Ontario  & 3.97                         \\
        \hline
    \end{tabular}
    \caption{Time to ``drain'' each of the Great Lakes}
    \label{table:drain_times}
\end{table}

\subsection{An additional explanation}

We have assumed that volume of all the lakes remain constant, meaning that the inflow rate \(r_{i}\) is equal to the outflow rate \(r\). To model this problem in an even simpler manner, we can think of each lake as a full cup of water with soda syrup dissolved in it. If we were to place the cup over a sink, and start pouring water into the cup while letting the water-syrup mixture flow out of the cup, we would eventually end up with a cup full of only water, as the syrup would be washed away by the inflowing water. The time it would take to completely wash away the syrup from the cup can be computed by dividing the volume of the cup by the outflow rate. Notice how the volume of the cup remains constant (full).

% figure?

\newpage \section{Assuming clean water inflow}

\begin{framed}
    \noindent A better estimate is obtained by assuming that each lake is a separate tank with \emph{only} clean water flowing in. Use this approach to determine how long it would take the pollution level in each lake to be reduced to 50\% of its original level. How long would it take to reduce the pollution to 5\% of its original level?
\end{framed}

Let us consider the following notation:
\begin{itemize}
    \item \(V\) - volume of the lake ($\unit{\cubic\mile}$)
    \item \(r\) - outflow rate ($\unit{\cubic\mile \per \text{year}}$)
    \item \(C(t)\) - concentration of pollutant in the lake at time \(t\) ($\unit{\kilo\gram / \cubic\mile}$) (mass per unit volume = $\frac{y(t)}{V}$)
    \item \(C_0\) - initial concentration of pollutant in the lake at time \(t = 0\) ($\unit{\kilo\gram / \cubic\mile}$)
    \item \(y(t)\) - mass of pollutant in the lake at time \(t\) ($\unit{\kilo\gram}$)
\end{itemize}

The rate of change of the mass of pollutant in a lake is equal to the inflow of the pollutant minus the outflow of the pollutant:
\begin{gather*}
    \frac{\d y}{\d t} = \text{inflow of pollutant} - \text{outflow of pollutant}
\end{gather*}
Since inflow water is clean, the inflow of pollutant is equal to zero:
\begin{gather*}
    \frac{\d y}{\d t} = 0 - \text{outflow of pollutant}
\end{gather*}
The outflow of pollutant is equal to the outflow rate of the lake times the concentration of pollutant in the lake (this number represents the amount of pollutant leaving the lake as water flows out):
\begin{gather*}
    \frac{\d y}{\d t} = - r \cdot C(t)
\end{gather*}
Since concentration is defined as mass per unit volume, we can rewrite the formula as:
\begin{gather*}
    \frac{\d y}{\d t} = - \frac{r}{V} \cdot  y(t)
\end{gather*}

This is a separable equation, so we can solve it by first separating the variables on opposite sides of the equation:
\begin{gather*}
    \frac{1}{y}  dy = -\frac{r}{V} dt
\end{gather*}
Next, we integrate both sides of the equation to reach the implicit solution:
\begin{gather*}
    \int \frac{1}{y}  dy = \int -\frac{r}{V} dt \\
    ln(y) = -\frac{r}{V} \cdot t + C \\
    e^{ln(y)} = e^{-\frac{r}{V} \cdot t} \cdot e^{C} \\
    y = e^{-\frac{r}{V} \cdot t} \cdot C
\end{gather*}

To determine \(C\), we use the initial condition that at time \(t = 0\), the mass of pollutant is equal to the initial one \(y_0\):
\begin{gather*}
    y(0) = e^{-\frac{r}{V} \cdot 0} \cdot C \implies C = y_0
\end{gather*}
Therefore, the rate of change of the mass of pollutant in the lake over time is dependent on the initial mass:
\begin{gather*}
    y(t) = y_0 e^{-\frac{r}{V} \cdot t}
\end{gather*}
From section~\ref{sec:draining_lakes} we know the values of $\frac{V}{r}$, which in here we can denote as \(\tau\). In this manner, the final form  of our equation becomes:
\begin{equation}
    y(t) = y_0 e^{-\frac{t}{\tau}}
    \label{eq:concentration_over_time}
\end{equation}

\subsection{Time to reduce pollution to 50\%} \label{sec:reduce_50_percent}

To find the time \(t\) it takes to reduce the pollution to 50\% of its original level, we must find the \(t\) such that:
\begin{gather*}
    y(t) = 0.5 \cdot y_0
\end{gather*}
Using equation~\eqref{eq:concentration_over_time}, we have:
\begin{gather*}
y_0 e^{-\frac{t}{\tau}} = 0.5 \cdot y_0 \\
    e^{-\frac{t}{\tau}} = 0.5 \\
    -\frac{t}{\tau}  = \ln(0.5) \\
    t = - \tau \ln(0.5) \\
    t = - \tau \cdot 0.6931
\end{gather*}

An important observation is that, since the initial level of pollutant \(y_0\) cancels out, the time to reduce pollution is independent of its initial mass.

Table~\ref{table:reduce_50_percent_times} shows the computed times to reduce the pollution level to 50\% of its original one for each lake, using the given volumes and outflow rates.

\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|}

        \hline

        Lake     & Time (in years) to reduce pollution to 50\% \\

        \hline

        Superior & 134.01                                      \\
        \hline
        Michigan & 21.52                                       \\
        \hline
        Huron    & 8.66                                        \\
        \hline
        Erie     & 0.95                                        \\
        \hline
        Ontario  & 2.75                                        \\
        \hline
    \end{tabular}
    \caption{Time to reduce pollution to 50\% in each of the Great Lakes}
    \label{table:reduce_50_percent_times}
\end{table}

\subsection{Time to reduce pollution to 5\%}

Similarly, as in section~\ref{sec:reduce_50_percent}, the time \(t\) it takes for each lake to reduce the pollution level to 5\% of its original level can be computed with:
\begin{gather*}
    t = -{\tau} \cdot \ln(0.05) \\
    t = -\tau \cdot 2.9957
\end{gather*}

Table~\ref{table:reduce_5_percent_times} shows the computed times to reduce the pollution level to 5\% of its original level for each lake, using the given volumes and outflow rates.

\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|}

        \hline

        Lake     & Time (in years) to reduce pollution to 5\% \\

        \hline

        Superior & 579.17                                     \\
        \hline
        Michigan & 93.03                                      \\
        \hline
        Huron    & 37.45                                      \\
        \hline
        Erie     & 4.09                                       \\
        \hline
        Ontario  & 11.89                                      \\
        \hline
    \end{tabular}
    \caption{Time to reduce pollution to 5\% in each of the Great Lakes}
    \label{table:reduce_5_percent_times}
\end{table}

Figure~\ref{fig:pollution_decay} illustrates the reduction (\emph{decay}) of pollution in each of the Great Lakes over time, assuming clean water inflow. The plot was generated using the \texttt{matplotlib} library in Python. The code can be found in listing~\ref{lst:pollution-reduction-plot}.

% The plot not only visualizes the timescale of pollution reduction, but also emphasizes the exponential nature of the pollution reduction process, as described by equation~\eqref{eq:concentration_over_time}. It also highlights the differences in time scales among the lakes, which depend on the outflow rate to volume ratio of the lakes. For instance, Lake Superior takes significantly longer to reduce pollution compared to Lake Erie, due to its larger volume and lower outflow rate relative to its size.
\begin{figure}[H]
    \centering
    \scalebox{0.85}{\input{assets/pollution_decay.pgf}}
    \caption{Reduction of pollution in the Great Lakes over time, assuming clean water inflow}
    \label{fig:pollution_decay}
\end{figure}

\paragraph{One more step of modelling.} Of course, lakes do not exist in isolation, and the outflow of one lake often serves as the inflow for another, meaning that pollutants can be transferred between lakes. The next section takes modelling a step further by taking this into consideration, for the highest level of accuracy in estimating pollution reduction times.

\newpage \section{Taking into account flow between lakes}

\begin{framed}
    \noindent Finally, to take into account the fact that pollution from one lake flows into the next lake in the chain, use the entire multiple compartment model given to determine when the pollution level in each lake has been reduced to 50\% of its original level, assuming pollution has ceased (that is, inflows not from a lake are clean water). Assume that all the lakes initially have the same pollution concentration p. How long would it take for the pollution to be reduced to 5\% of its original level?
\end{framed}

\newpage \printbibliography

\newpage \appendix
\section{Code listings}
\begin{lstlisting}[caption={Python code used to generate the pollution reduction plot shown in figure~\ref{fig:pollution_decay}},
                   label={lst:pollution-reduction-plot}]
import numpy as np
import matplotlib.pyplot as plt
import matplotlib
import json

plt.figure()

# max years to be shown
t_max = 700  # years
# number of points on x axis (time) to be computed
t = np.linspace(0, t_max, 500)

# load lake data from json
with open('lakes.json'), 'r') as file:
    data = json.load(file)

    for lake, values in data.items():
        k = values["outflow"] / values["vol"] # k = Q_out / V
        P = np.exp(-k * t) * 100 # e^(-kt), in percentage
        plt.plot(t, P, label=f"Lake {lake}")

# Add horizontal lines for 50% and 5%
plt.axhline(50, color='blue', linestyle='--', linewidth=1, label=r"50% remaining")
plt.axhline(5, color='red', linestyle='--', linewidth=1, label=r"5% remaining")

plt.xlabel("Time (years)")
plt.ylabel("Pollution Concentration (% of initial)")
plt.legend()
plt.grid(True)
plt.tight_layout()

# show plot
plt.show()
\end{lstlisting}

\end{document}